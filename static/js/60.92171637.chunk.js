(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[60,73,74,75],{117:function(e,t,a){"use strict";a.r(t),a.d(t,"getChoice",(function(){return _})),a.d(t,"getFactChartType",(function(){return I})),a.d(t,"default",(function(){return L}));var r=a(113),n=a.n(r),o=a(20),c=a(10),i=a(419),s=a(4),u=a(5),p=a(9),l=a(8),d=a(2),f=a.n(d),h=a(428),g=a(590),m=(a(90),a(51)),v=a.n(m),b=(a(7),a(121)),y=a(3),j=(a(122),a(123)),O=a(405),E=a(83),T=a(397),x=a(523),w=a(52),S=a(27),k=a(32),D=a(12),C=a.n(D),_=function(e){return Math.round(Math.random()*(e-1))},I=function(e,t){var a=Object(k.a)(t,e);return 0===a.length?null:a[_(a.length)].chart},L=function(e){Object(p.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,u=new Array(r),p=0;p<r;p++)u[p]=arguments[p];return(e=t.call.apply(t,[this].concat(u))).deleteVideoSlice=function(t){e.props.isPlayVideo||(e.props.removeCard(t),e.props.deleteBarFromTimeLineBar(t),e.props.deleteFact(t))},e.generateTransitionFacts=function(t){new Promise(function(){var a=Object(i.a)(n.a.mark((function a(r,i){var s,u,p,l,d,f,h,g,m,v,b,j,k,D,_,L,A,F,N,R,G,P,q,B,U,V,M,J,z,H;return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("generateTransitionFacts"+t),s=e.props.cardItems[t],u=e.props.cardItems[t+1],p=e.props.fileName,l={type:s.fact.type,measure:s.fact.measure,subspace:s.fact.subspace,groupby:s.fact.groupby,focus:s.fact.focus},d={type:u.fact.type,measure:u.fact.measure,subspace:u.fact.subspace,groupby:u.fact.groupby,focus:u.fact.focus},e.setState({operateState:E.a.GENERATING}),e.props.isUpdateEditing(!0),f={file_name:p,max_story_length:4,method:"guided",start:l,end:d},a.next=11,O.d(T.a.url.generateRandomly,f);case 11:(h=a.sent).data.fail&&(console.log("fail"),e.setState({operateState:E.a.ADD_FAILED,errorMessage:h.data.fail}),i()),h.data.error&&(console.log("error"),e.setState({operateState:E.a.ADD_FAILED,errorMessage:h.data.error}),i()),g=h.data.story.facts,m=[],v=Object(c.a)(g);try{for(v.s();!(b=v.n()).done;)j=b.value,(k=new x.a(j.type,j.measure,j.subspace,j.groupby,j.focus,j.parameter,"",j.score,j.information,j.significance)).generatedScript=Object(w.a)(k,e.state.lang),m.push(k)}catch(n){v.e(n)}finally{v.f()}console.log(m.length),D=0,_=[],L=[],A=0,F=m;case 23:if(!(A<F.length)){a.next=60;break}if(N=F[A],1!=m.length&&2!=m.length){a.next=27;break}return a.abrupt("break",60);case 27:if(0!=D&&D!=m.length-1){a.next=30;break}return D++,a.abrupt("continue",57);case 30:if(R=C.a.cloneDeep(e.props.schemaFilterLocal),G=e.props.schema,P=void 0,P=R?{schema:R}:{schema:G},N.chart&&""!==N.chart||(N.chart=I(P.schema,N)),N.chart===y.a.ISOTYPE_BAR_CHART&&(N.chart=y.a.VERTICAL_BAR_CHART),N.chart&&Object(S.b)(N)){a.next=40;break}return console.log("no valid",N),a.abrupt("return",null);case 40:q=C.a.cloneDeep(e.props.dataresLocal),P=Object(o.a)(Object(o.a)({},P),{},{values:q}),null,U=void 0,U=(B={width:135,height:86})?{width:B.width,height:B.height,type:"unitvis",style:"business",duration:0,showSuggestion:!0}:{size:null,type:"unitvis",style:"business",duration:0,showSuggestion:!0},V=Object(o.a)(Object(o.a)({},N),{},{breakdown:N.groupby.map((function(e){return{field:e}})),index:D}),M={data:P,fact:V,chart:U},6e3,J=t+D,e.props.insertFactByFact(N,J),z={fact:N,spec:M,time:6e3,isGeneratedByAlg:!0},_.push(z),H={leftbar:140,rightbar:18,isDrag:!1},L.push(H),D++;case 57:A++,a.next=23;break;case 60:e.props.addCards(_,t+1),e.props.addBarsToTimeLineBar(L,t+1),e.setState({operateState:E.a.GENERATED}),e.props.isUpdateEditing(!1),r(h);case 65:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.videoIndex,r=t.index,n=(C.a.cloneDeep(this.props.dataresLocal),C.a.cloneDeep(this.props.schemaFilterLocal)),o=this.props.schema;var c,i=v()();return c="empty"!==this.props.spec?Object(g.b)(this.props.spec,i):null,console.log("herererre"),f.a.createElement("div",Object.assign({className:"video-slice-card",ref:this.props.provided.innerRef},this.props.provided.draggableProps,this.props.provided.dragHandleProps),f.a.createElement("div",{className:"complete-card",style:{background:"#f4f4f4"}},f.a.createElement("div",{className:"above-card"},f.a.createElement("div",{className:"fact-description"}),f.a.createElement("div",{className:"delete-card-btn",onClick:function(){return e.deleteVideoSlice(r)}},f.a.createElement(h.a,null))),f.a.createElement(b.default,Object.assign({index:r,videoIndex:a,vis:c,playVideoSlice:this.props.playVideoSlice,setLeftsiderContent:this.props.setLeftsiderContent},this.props)),f.a.createElement(j.default,Object.assign({spec:this.props.spec,videoIndex:a,index:r},this.props))))}}]),a}(f.a.Component)},121:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return l}));var r=a(4),n=a(5),o=a(9),c=a(8),i=a(2),s=a.n(i),u=a(7),p=a(549),l=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){var e;Object(r.a)(this,a);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).editClickSlice=function(t){e.props.setLeftsiderContent(u.a.SET_EDIT_SLICE)},e}return Object(n.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){console.log("~~~~~~~~~~",this.props);var a=this.props.narrative_spec,r=e.narrative_spec;return!Object(p.b)(p.a.fromJS(a),p.a.fromJS(r))}},{key:"render",value:function(){var e=this,t=this.props,a=t.vis,r=t.index;return s.a.createElement("div",{className:"below-card",onClick:function(){return e.editClickSlice(r)}},a)}}]),a}(s.a.Component)},122:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return u}));var r=a(4),n=a(5),o=a(9),c=a(8),i=a(2),s=a.n(i),u=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(n.a)(a,[{key:"render",value:function(){var e=this.props,t=e.index,a=(e.videoIndex,t+1<10?"0"+(t+1):""+(t+1));return s.a.createElement("div",{className:"footer-card"},s.a.createElement("div",{className:"footer-num",style:{backgroundColor:"#E4F2FB"}},a))}}]),a}(s.a.Component)},123:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return u}));var r=a(4),n=a(5),o=a(9),c=a(8),i=a(2),s=a.n(i),u=function(e){Object(o.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(n.a)(a,[{key:"render",value:function(){var e=this.props,t=(e.index,e.videoIndex,e.spec,this.props.spec.actions),a=t[t.length-1].style.text;return s.a.createElement("div",{className:"footer-caption"},s.a.createElement("div",{className:"footer-text",style:{}},a))}}]),a}(s.a.Component)},143:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return b}));var r=a(113),n=a.n(r),o=a(419),c=a(4),i=a(5),s=a(9),u=a(8),p=a(2),l=a.n(p),d=a(724),f=a(117),h=(a(727),a(590)),g=a(405),m=a(397),v=a(7),b=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).addVideoSlice=function(){r.props.addEmptyCard()},r.onDragStart=function(){console.log("drag start!")},r.onDragEnd=function(e){if(console.log("drag end!"),e.destination){var t=e.source.index,a=e.destination.index;t!=a&&"comparative"==r.props.narrative_spec.operators[t].type&&"comparative"==r.props.narrative_spec.operators[a].type&&(console.log("origin"+t),console.log("target"+a),r.props.changeOperator(t,a),new Promise(function(){var e=Object(o.a)(n.a.mark((function e(t,a){var o,c,i,s,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=r.props.narrative_spec.operators).splice(o.length-1,1),c="",o.map((function(e,t){var a=e.args,r=a.substring(1,a.length-1).replace(/\[/g,"").replace(/\]/g,"").replace(/\'/g,"").replace(/,/g,"").replace(/tbl\|/g,"tbl:").replace(/col\|/g,"col:").replace(/col\|/g,"col:").replace(/comparative\|>\|/g,"great/").replace(/comparative\|<\|/g,"less/").replace(/comparative\|>=\|/g,"greatequal/").replace(/comparative\|<=\|/g,"lessequal/").replace(/comparative\|=\|/g,"equal/").replace(/comparative\|!=\|/g,"notequal/").replace(/(?<=\/\d+)\D*?(?=col)/g," ").replace(/\|/g,"/");c=c+e.type+" "+r+", "})),c=c.substring(0,c.length-2),i={correction:c,operators:r.props.narrative_spec.operators},s={csvname:r.props.fileName,question:r.props.question,correction:i},r.props.isGeneratingGIF(!0),e.next=10,g.e(m.a.url.question2gif,s);case 10:(u=e.sent).data.fail&&(console.log("fail"),r.setState({operateState:OperationType.ADD_FAILED,errorMessage:u.data.fail}),a()),u.data.error&&(console.log("error"),r.setState({operateState:OperationType.ADD_FAILED,errorMessage:u.data.error}),a()),r.props.isGeneratingGIF(!1),console.log(u.data),r.props.question2Gif(r.props.question,u.data),r.props.changeTempSpec(u.data),r.props.setLeftsiderContent(v.a.SET_EDIT_SLICE),t(u);case 19:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()))}},r}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.dataresLocal,r=t.schemaFilterLocal,n=t.narrative_spec,o=(t.cardItems,t.videoIndex),c=Object(h.a)(n);return l.a.createElement("div",{className:"video-fact-control"},l.a.createElement(d.a,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd},l.a.createElement(d.c,{droppableId:"storyline",direction:"horizontal"},(function(t,n){return l.a.createElement("div",Object.assign({className:"video-slice",ref:t.innerRef},t.droppableProps),c.map((function(t,n){return l.a.createElement(d.b,{key:n,draggableId:n+"",index:n},(function(c,i){return l.a.createElement(f.default,Object.assign({videoIndex:o,index:n,provided:c,spec:t,dataresLocal:a,schemaFilterLocal:r},e.props))}))})),t.placeholder)}))))}}]),a}(l.a.Component)},397:function(e,t,a){"use strict";var r="http://calliope-dev.idvxlab.com",n="https://".concat("calliope-service.idvxlab.com",":8002/api/v1"),o="https://".concat("urania-api.idvxlab.com:8006"),c="https://".concat("calliope-service.idvxlab.com",":8002/log/v1"),i="https://".concat("urania-api.idvxlab.com:8006"),s="https://".concat("urania-api.idvxlab.com:8006"),u="https://account.datacalliope.com",p={url:{share:"".concat(i,"/share"),applicationUrl:r,publicPrefix:"http://calliope-dev.idvxlab.com",loginadmintest:"".concat(n,"/loginadmintest"),loginRedirectUrl:"".concat(u,"/#/login?response_type=code&client_id=").concat("6dcd0f8b-6990-4d69-9018-29b3351aa6ff","&grant_type=authorization_code&redirect_uri=").concat(r),logoutRedirectUrl:"".concat(r,"/#/logout"),authenUrl:u,accessToken:"".concat(n,"/accesstoken"),userImage:"".concat("https://service.datacalliope.com:8001","/img"),checkToken:"".concat(n,"/checktoken"),logout:"".concat(n,"/logout"),logoutAuthSystem:"".concat("https://service.datacalliope.com:8001","/logout"),users:"".concat(n,"/users"),activitiesApi:"".concat(c,"/users"),uploadDataPrefix:i,uploadData:"".concat(i,"/upload"),uploadGraphData:"".concat(i,"/uploadGraph"),fetch:"".concat(i,"/data/share"),factScoring:"".concat(o,"/fact"),generateRandomly:"".concat(o,"/generate"),generateGraphRandomly:"".concat(o,"/generateGraphRandomly"),filteredGenerate:"".concat(o,"/filteredgenerate"),question2gif:"".concat(s,"/edit_decompose")}};t.a=p},405:function(e,t,a){"use strict";a.d(t,"g",(function(){return d})),a.d(t,"d",(function(){return h})),a.d(t,"e",(function(){return g})),a.d(t,"b",(function(){return m})),a.d(t,"f",(function(){return v})),a.d(t,"c",(function(){return y})),a.d(t,"a",(function(){return O}));var r=a(113),n=a.n(r),o=a(419),c=a(432),i=a.n(c),s=a(543),u=function(e,t){var a="";return a+=e,"object"===typeof t&&0!==Object.keys(t).length&&(a+="?".concat(Object(s.stringify)(t))),a},p=function(e){var t=e.url,a=e.method,r=e.param,n=e.data;return new Promise((function(e,o){i()({method:a,url:u(t,r),data:n}).then((function(t){t.status>=400?o():200===t.status||201===t.status||204===t.status?e(t.data):o()})).catch((function(e){o()}))}))},l=a(397);function d(e){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){i()({method:"post",url:"".concat(l.a.url.uploadData),config:{headers:{"Content-Type":"multipart/form-data"}},data:t}).then((function(t){t.status>=400?a():200===t.status||201===t.status||204===t.status?e(t.data):a()})).catch((function(e){a()}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t){return i()({method:"post",url:e,config:{headers:{"Content-Type":"application/json; charset=utf-8"}},data:t})}function g(e,t){return i()({method:"post",url:e,config:{headers:{"Content-Type":"application/json; charset=utf-8"}},data:t})}function m(e,t,a,r){return i()({method:"POST",url:l.a.url.factScoring,headers:{"Content-Type":"application/json; charset=utf-8"},data:{file_name:e,fact:t,filters:a,method:r}})}function v(e){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){i()({method:"post",url:"".concat(l.a.url.share),config:{headers:{"Content-Type":"application/json; charset=utf-8"}},data:{share_json:t}}).then((function(t){t.status>=400?a():200===t.status||201===t.status||204===t.status?e(t.data):a()})).catch((function(e){a()}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return j.apply(this,arguments)}function j(){return(j=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i()({method:"get",url:"".concat(l.a.url.fetch,"/").concat(t,".json"),config:{headers:{"Content-Type":"application/json; charset=utf-8"}}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(n.a.mark((function e(t,a){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({url:"".concat(l.a.url.activitiesApi,"/lite/activities"),method:"post",param:{},data:a});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},429:function(e,t){var a,r,n=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function i(e){if(a===setTimeout)return setTimeout(e,0);if((a===o||!a)&&setTimeout)return a=setTimeout,setTimeout(e,0);try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}!function(){try{a="function"===typeof setTimeout?setTimeout:o}catch(e){a=o}try{r="function"===typeof clearTimeout?clearTimeout:c}catch(e){r=c}}();var s,u=[],p=!1,l=-1;function d(){p&&s&&(p=!1,s.length?u=s.concat(u):l=-1,u.length&&f())}function f(){if(!p){var e=i(d);p=!0;for(var t=u.length;t;){for(s=u,u=[];++l<t;)s&&s[l].run();l=-1,t=u.length}s=null,p=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];u.push(new h(e,t)),1!==u.length||p||i(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},523:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(5),n=a(4),o=a(52),c=a(3),i=Object(r.a)((function e(t){var a=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;Object(n.a)(this,e),this.script=function(){return a.generatedScript},this.type=t,this.measure=r,this.subspace=i,this.groupby=s,this.focus=u,this.parameter=p,this.score=d,this.information=f,this.significance=h,this.chart=l,this.generatedScript=Object(o.a)(this),this.generatedSubtitle=Object(o.b)(this),this.duration=3e3,this.aggregated=!1,this.aggregatedFact=null,this.compoundType="",this.compoundChart=c.a.JUXTAPOSITION}))},590:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return i}));var r=a(44),n=a(2),o=a.n(n),c=function(e){var t={chart:e.chart,data:e.data,actions:[]},a=[],r=[],n=[];return e.actions&&((a=_.cloneDeep(e.actions)).map((function(e,t){"title"===e.add&&-1!==e.style.duration&&r.push(t)})),r.map((function(e){var r=a.slice(0,e+1);r.map((function(e){e.style&&(e.style.delay=0,e.style.duration=0)})),r.map((function(e,t){"title"===e.add&&t!==r.length-1&&r.splice(t,1)}));var o=_.cloneDeep(t);o.actions=r,n.push(o)}))),n},i=function(e,t){return o.a.createElement(r.a,{spec:e,uuid:t})}}}]);
//# sourceMappingURL=60.92171637.chunk.js.map