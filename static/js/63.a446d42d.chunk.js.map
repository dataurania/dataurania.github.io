{"version":3,"sources":["pages/EditPage/EditDataVideos/VideoShow/VideoDisplay.js","../node_modules/antd/es/_util/reactNode.js","../node_modules/antd/es/_util/type.js","axios/config.js","axios/base.js","axios/api.js","tool/narrative2cards.js"],"names":["Content","Footer","VideoDisplay","Header","this","narrative","NarrativeChart","container","load","props","narrative_spec","generate","console","log","nextProps","operatorChange","nextState","JSON","stringify","isGenerating","isPlayVideo","className","tip","spinning","id","React","Component","isValidElement","cloneElement","element","replacement","replaceElement","tuple","_len","arguments","length","args","Array","_key","applicationUrl","urlPrefix","generationUrlPrefix","activitiesPrefix","uploadDataPrefix","question2gifPrefix","accountIp","config","url","share","publicPrefix","loginadmintest","loginRedirectUrl","logoutRedirectUrl","authenUrl","accessToken","userImage","checkToken","logout","logoutAuthSystem","users","activitiesApi","uploadData","uploadGraphData","fetch","factScoring","generateRandomly","generateGraphRandomly","filteredGenerate","question2gif","composeUrl","qs","result","Object","keys","requestWithoutCredentials","method","param","data","Promise","reslove","reject","axios","then","response","status","catch","error","formData","a","filename","fact","filters","shareStory","jsonstring","fetchStory","uid","body","req","narrative_spec2cards","spec","chart","actions","idx_titleaction","step_actions","_","cloneDeep","map","item","index","add","style","duration","push","d","eachaction","slice","delay","splice","step_spec","narrativespec2Vis","uuid"],"mappings":"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","file":"static/js/63.a446d42d.chunk.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Layout, Button } from \"antd\";\nconst { Footer, Content, Header } = Layout;\nimport { AutoVis } from 'calliope-chart';\nimport { NarrativeChart } from '@/vis';\nimport { Spin } from 'antd';\nimport * as api from '@/axios/api';\nimport config from '@/axios/config';\nimport uuidv4 from 'uuid/v4';\nimport { narrative_spec2cards } from '@/tool/narrative2cards';\n\n\n\nexport default class VideoDisplay extends React.Component {\n\n\n\n\n    //初始化\n    componentDidMount() {\n        this.narrative = new NarrativeChart();\n        this.narrative.container('#video-chart');\n        this.narrative.load(this.props.narrative_spec);\n        this.narrative.generate();\n        console.log('初始化 ........')\n\n        // console.log('~~~~~~~~', this.props.narrative_spec)\n        \n        // this.autovis = new AutoVis();\n        // this.autovis.container('#video-chart');\n        // this.autovis.paragraph('#video-caption');\n        // this.autovis.shouldShowCaption(true);\n        // this.autovis.load(this.props.currentSpec);\n        // this.autovis.generate();\n    }\n    //更新时\n    componentDidUpdate(nextProps) {\n\n/* \n        if(this.props.question=='What is the average income of people with different education.')\n            {var  nowVideoIndex = 3;}\n        else\n            {var nowVideoIndex = 4;}\n        \n        // 从暂停的index开始播放\n        let newSpec = _.cloneDeep(this.props.narrative_spec)\n\n        if(this.props.narrative_spec){\n        let titleArray = []\n        newSpec.actions.map((item, index) => {\n            if(item.add === \"title\" && item.style.duration !== -1)\n            titleArray.push(index)\n        })\n\n        let durationArray = []\n        titleArray.map((item, index) => {\n            let duration = newSpec.actions[item].style.duration\n            durationArray.push(duration)\n        })\n\n        let allDelay = 0\n        for(let i =0;i<nowVideoIndex;i++){\n            allDelay = allDelay+durationArray[i]\n        }\n\n        let gapIndex = titleArray[nowVideoIndex-1]+1\n        for(let i =0;i<gapIndex;i++)\n            {\n                if(newSpec.actions[i].style){\n                    newSpec.actions[i].style.duration = 0\n                    newSpec.actions[i].style.delay = 6000000\n                    if(newSpec.actions[i].style.text)\n                        newSpec.actions[i].style.text = ''\n                    \n                }\n            }\n        \n        for(let j =gapIndex;j<newSpec.actions.length;j++){\n            if(newSpec.actions[j].style)\n                newSpec.actions[j].style.delay = newSpec.actions[j].style.delay - allDelay\n        }\n\n\n        this.narrative = new NarrativeChart();\n        this.narrative.container('#video-chart');\n        this.narrative.load(newSpec);\n        this.narrative.generate();\n        } */\n\n\n        this.narrative = new NarrativeChart();\n        this.narrative.container('#video-chart');\n        this.narrative.load(this.props.narrative_spec);\n        this.narrative.generate();\n        \n        console.log('this.props.narrative_spec ..... '+ this.props.narrative_spec)\n        console.log('重新加载 ..........')\n        this.props.operatorChange(false)\n        \n    }\n\n    //何时该更新\n    shouldComponentUpdate(nextProps,nextState){\n        \n        if(JSON.stringify(this.props.narrative_spec)!=JSON.stringify(nextProps.narrative_spec)\n            ||this.props.isGenerating!=nextProps.isGenerating||(this.props.isPlayVideo==false&&nextProps.isPlayVideo==true)\n            )\n            {console.log('updating ..............')\n            return true}\n        else\n            return false\n    }\n\n    render(){\n        return(\n            <Content className='center-canvas'>\n                <Spin tip=\"Generating...\" spinning={this.props.isGenerating}>\n                <div className='canvas-video-display'>\n                    <div id=\"video-chart\" className='video-chart'>\n                    </div>\n                </div>\n                </Spin>\n            </Content>\n        )\n    }\n}","import * as React from 'react';\nvar isValidElement = React.isValidElement;\nexport { isValidElement };\nexport function replaceElement(element, replacement, props) {\n  if (!isValidElement(element)) return replacement;\n  return /*#__PURE__*/React.cloneElement(element, typeof props === 'function' ? props(element.props || {}) : props);\n}\nexport function cloneElement(element, props) {\n  return replaceElement(element, element, props);\n}","// https://stackoverflow.com/questions/46176165/ways-to-get-string-literal-type-of-array-values-without-enum-overhead\nexport var tuple = function tuple() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  return args;\n};\nexport var tupleNum = function tupleNum() {\n  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n    args[_key2] = arguments[_key2];\n  }\n\n  return args;\n};","//let calliopeService = 'service.datacalliope.com';\nlet calliopeService = 'calliope-service.idvxlab.com';\n//let calliopeLiteService = 'calliope-service.idvxlab.com:8004';\n// let calliopeLiteService = 'service.datacalliope.com:8002';\n\n// let calliopeLiteService = 'calliope-service.idvxlab.com:8002';\nlet calliopeLiteService = 'urania-api.idvxlab.com:8006';\n// let applicationUrl='https://datacalliope.com';\nlet applicationUrl = 'http://calliope-dev.idvxlab.com';\n\nlet urlPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeService}:8002/api/v1` : 'http://localhost:7001/api/v1';\n// let uploadDataPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeLiteService}` : 'http://localhost:6028';//todo  7001\nlet generationUrlPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeLiteService}` : 'http://localhost:6010';//todo  7001\n\n// let question2gifPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeLiteService}` : 'http://localhost:6030';//todo  7001\n\n\nlet activitiesPrefix = process.env.NODE_ENV === 'production' ? `https://${calliopeService}:8002/log/v1` : 'http://localhost:7002/log/v1';//\nlet publicPrefix = process.env.NODE_ENV === 'production' ? applicationUrl : 'http://localhost:3000';\n//let client_id = '033338f2-02a8-44d4-8d54-5173b4a864f9';\n\nlet uploadDataPrefix = `https://${calliopeLiteService}`;\nlet question2gifPrefix =`https://${calliopeLiteService}` ;\n// let urlPrefix = `https://${calliopeService}:8002/api/v1` ;\n// let uploadDataPrefix  = `https://${calliopeLiteService}`;//todo  7001\n// let generationUrlPrefix = `https://${calliopeLiteService}`;//todo  7001\n// let activitiesPrefix = `https://${calliopeService}:8002/log/v1`;//\n// let publicPrefix = applicationUrl ;\nlet client_id = '6dcd0f8b-6990-4d69-9018-29b3351aa6ff';\nlet accountIp = `https://account.datacalliope.com`\nlet logoutRedirectUrlIp = `https://service.datacalliope.com:8001`\n\nconst config = {\n    url: {\n        share: `${uploadDataPrefix}/share`,\n        applicationUrl: applicationUrl,\n        //share\n        publicPrefix: publicPrefix,\n        //login\n        loginadmintest: `${urlPrefix}/loginadmintest`,\n        loginRedirectUrl: `${accountIp}/#/login?response_type=code&client_id=${client_id}&grant_type=authorization_code&redirect_uri=${applicationUrl}`,\n        logoutRedirectUrl: `${applicationUrl}/#/logout`,\n        authenUrl: accountIp,\n        accessToken: `${urlPrefix}/accesstoken`,\n        userImage: `${logoutRedirectUrlIp}/img`,\n        checkToken: `${urlPrefix}/checktoken`,\n        //logout\n        logout: `${urlPrefix}/logout`,\n        logoutAuthSystem: `${logoutRedirectUrlIp}/logout`,\n        //activities\n        users: `${urlPrefix}/users`,\n        activitiesApi: `${activitiesPrefix}/users`,\n        //upload\n        uploadDataPrefix: uploadDataPrefix,\n        uploadData: `${uploadDataPrefix}/upload`,\n        uploadGraphData: `${uploadDataPrefix}/uploadGraph`,\n        \n        fetch: `${uploadDataPrefix}/data/share`,\n        //story generation\n        factScoring: `${generationUrlPrefix}/fact`,\n        generateRandomly: `${generationUrlPrefix}/generate`,\n        generateGraphRandomly: `${generationUrlPrefix}/generateGraphRandomly`,\n\n        //data filter\n        filteredGenerate:`${generationUrlPrefix}/filteredgenerate`,\n\n        // data gif\n        question2gif:`${question2gifPrefix}/edit_decompose`\n    }\n}\nexport default config","import axios from 'axios';\nimport { stringify } from 'query-string';\n// import config from '@/axios/config';\n\nconst composeUrl = function (url, qs) {\n    let result = '';\n    // if (url[0] !== '/') {\n    //   result += '/';\n    // }\n    result += url;\n    if (typeof qs === 'object' && Object.keys(qs).length !== 0) {\n        result += `?${stringify(qs)}`;\n    }\n    return result;\n};\n\nexport const request = ({ url, method, param, data }) => {\n    return new Promise((reslove, reject) => {\n        axios({\n            method: method,\n            url: composeUrl(url, param),\n            data: data,\n            withCredentials: true,\n            // headers: { 'token': Cookies.get('userInfo') ? JSON.parse(Cookies.get('userInfo')).token : null },\n        }).then((response) => {\n            if (response.status >= 400) {\n                reject();\n            } else if (response.status === 200 || response.status === 201 || response.status === 204) {\n                reslove(response.data);\n            } else {\n                reject();\n            }\n        }).catch(error => {\n            if (error.response) {\n                if (error.response.status === 401) {\n                    //reject('401');\n                    reject()\n                    //退出登陆\n                    // axios({\n                    //     method: \"post\",\n                    //     url: `${config.url.logout}`,\n                    //     data: {},\n                    //     withCredentials: true\n                    // }).then((response) => {\n                    //     if (response.status === 200) {\n                    //         window.location.href = config.url.loginRedirectUrl //login first\n                    //     }\n                    // }).catch(\n                    // )\n                }\n            }\n            reject();\n        })\n    })\n};\n\nexport const requestWithoutCredentials = ({ url, method, param, data }) => {\n    return new Promise((reslove, reject) => {\n        axios({\n            method: method,\n            url: composeUrl(url, param),\n            data: data\n        }).then((response) => {\n            if (response.status >= 400) {\n                reject();\n            } else if (response.status === 200 || response.status === 201 || response.status === 204) {\n                reslove(response.data);\n            } else {\n                reject();\n            }\n        }).catch(error => {\n            reject();\n            //  message.error('error message');\n        })\n    })\n};\n\n","import * as req from './base';\nimport config from '@/axios/config';\nimport axios from 'axios';\n\n/**\n * 用户认证 相关接口\n * @param \n */\nexport async function checkToken() {\n    const data = await req.request({\n        url: `${config.url.checkToken}`,\n        method: 'post',\n        param: {},\n        data: {}\n    });\n    return data;\n}\n\nexport async function loginadmintest() {\n    const data = await req.request({\n        url: `${config.url.loginadmintest}`,\n        method: 'post',\n        param: {},\n        data: {}\n    });\n    return data;\n}\n\nexport async function accessToken(body) {\n    const data = await req.request({\n        url: `${config.url.accessToken}`,\n        method: 'post',\n        param: {},\n        data: body\n    });\n    return data;\n}\nexport async function logout() {\n    const data = await req.request({\n        url: `${config.url.logout}`,\n        method: 'post',\n        param: {},\n        data: {}\n    });\n    return data;\n}\n\n\nexport async function uploadData(formData) {\n    return new Promise((reslove, reject) => {\n        axios({\n            method: \"post\",\n            url: `${config.url.uploadData}`,\n            config: {\n                \"headers\": {\n                    'Content-Type': 'multipart/form-data' //application/json; charset=utf-8\n                },\n            },\n            data: formData\n        }).then((response) => {\n            if (response.status >= 400) {\n                reject();\n            } else if (response.status === 200 || response.status === 201 || response.status === 204) {\n                reslove(response.data);\n            } else {\n                reject();\n            }\n        }).catch(error => {\n            reject();\n            //  message.error('error message');\n        })\n    })\n}\n\n\nexport function filteredgenerate(url, data) {\n    return axios({\n        method: \"post\",\n        url: url,\n        config: {\n            \"headers\": {\n                'Content-Type': 'application/json; charset=utf-8'\n            },\n        },\n        data: data\n    })\n}\n\nexport function generate(url, data) {\n    return axios({\n        method: \"post\",\n        url: url,\n        config: {\n            \"headers\": {\n                'Content-Type': 'application/json; charset=utf-8'\n            },\n        },\n        data: data\n    })\n}\n\nexport function question2gif(url, data) {\n    return axios({\n        method: \"post\",\n        url: url,\n        config: {\n            \"headers\": {\n                'Content-Type': 'application/json; charset=utf-8'\n            },\n        },\n        data: data\n    })\n}\n\n\nexport function factScoring(filename, fact,filters, method) {\n    return axios({\n        \"method\": \"POST\",\n        \"url\": config.url.factScoring,\n        \"headers\": {\n            \"Content-Type\": \"application/json; charset=utf-8\"\n        },\n        \"data\": {\n            \"file_name\": filename,\n            \"fact\": fact,\n            \"filters\":filters,\n            \"method\": method,\n        }\n    })\n}\n\nexport async function shareStory(jsonstring) {\n    return new Promise((reslove, reject) => {\n        axios({\n            method: \"post\",\n            url: `${config.url.share}`,\n            config: {\n                \"headers\": {\n                    'Content-Type': 'application/json; charset=utf-8'\n                },\n            },\n            data: {\n                \"share_json\": jsonstring\n            }\n        }).then((response) => {\n            if (response.status >= 400) {\n                reject();\n            } else if (response.status === 200 || response.status === 201 || response.status === 204) {\n                reslove(response.data);\n            } else {\n                reject();\n            }\n        }).catch(error => {\n            reject();\n            //  message.error('error message');\n        })\n    })\n}\n\nexport async function fetchStory(id) {\n    return axios({\n        method: \"get\",\n        \"url\": `${config.url.fetch}/${id}.json`,\n        config: {\n            \"headers\": {\n                'Content-Type': 'application/json; charset=utf-8'\n            },\n        }\n    })\n}\n/*****\n *技术栈：\n ssr(后端渲染)，koa(koa-views)：模板渲染，渲染出要生成pdf的页面)\n node.js 生成pdf插件 puppeteer：将渲染的页面生成PDF\n koa-send：将生成的PDF返回给前端页面下载 \n * \n data是后端用于渲染页面的数据\n */\nexport function generatePDF(data) {\n    return axios({\n        method: 'post',\n        url: `/generatePDF`,\n        param: {},\n        data: data\n    })\n}\n\n/**\n * 数据|故事|评论 操作行为记录 API\n * @param \n */\n\nexport async function activitiesApi(uid, body) {\n    const data = await req.requestWithoutCredentials({\n        url: `${config.url.activitiesApi}/lite/activities`,\n        method: 'post',\n        param: {},\n        data: body\n    });\n    return data;\n}\n","import Chart from '@/Chart';\nimport React from 'react';\n\n\n\nexport const narrative_spec2cards = function(narrative_spec){\n    let spec = {\n        \"chart\" : narrative_spec.chart,\n        \"data\": narrative_spec.data,\n        \"actions\": []\n    }\n    \n    let actions = []\n    let idx_titleaction = []\n    let step_actions = []\n    if(narrative_spec.actions){\n        actions = _.cloneDeep(narrative_spec.actions)\n        actions.map((item, index) => {\n            if(item.add === \"title\" && item.style.duration !== -1)\n            idx_titleaction.push(index)\n        })\n        // duration delay = 0\n        idx_titleaction.map((d) => {\n            let eachaction = actions.slice(0,d+1)\n            eachaction.map((item) => {\n                if(item.style){\n                    item.style.delay = 0\n                    item.style.duration = 0\n                }\n\n            })\n            // remove extra title\n            eachaction.map((item, index) => {\n                if (item.add === \"title\" && index !== eachaction.length-1){\n                    eachaction.splice(index,1)\n                }\n            })\n            let step_spec = _.cloneDeep(spec)\n            step_spec.actions = eachaction\n            step_actions.push(step_spec)\n        })\n\n    }\n    return step_actions\n}\n\nexport const narrativespec2Vis = function(spec, uuid) {\n\n    return <Chart spec = {spec} uuid = { uuid }/>\n}"],"sourceRoot":""}